<!DOCTYPE html>
<html>
<head>
<title></title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="css/style.css" />
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script src="js/script.js" async></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body style="background-color: #e6e6e6">
<div class="container p-3 my-3 border">
    <nav class="navbar navbar-expand-sm bg-dark navbar-dark fixed-top" style="background-color: #262626 !important;">
        <div style="display:flex">
            <a class="navbar-brand" href="index.html">JavaScript30</a>
            <ul class="navbar-nav">
                <li class="nav-item dropdown ">
                    <button class="btn btn-secondary dropdown-toggle bg-dark" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Wyzwania
                    </button>
                    <div class="dropdown-menu" id="dropdown" aria-labelledby="dropdownMenuButton">
                        <div class="row" id="dropdown-row">
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </nav>
</div>

<div class="container p-3 bg-dark " style=" border-radius: 2rem; color:#e6e6e6 ">
    <h1 style="text-align:center"> Challenge 6 : Ajax Type Ahead </h1>
    <p style="text-indent:1rem;margin-bottom:0;">
        Wyzwanie polega na stworzeniu dynamicznej wyszukiwarki miast w USA wraz z jego populacją.
    </p>
    <div class="container my-3 p-2" id="challengeContainer">
        <div class="input-group p-3">
            <input type="text" class="form-control" placeholder="Type USA city..." id="challenge_6_input">

        </div>
        <ul id="City_research">
        </ul>
        <button type="button" class="btn btn-info" id="show_more">Show All...</button>
    </div>

    <p style="text-indent:1rem;margin-bottom:0;">
        Kod w javaScript który posłużył do zrobienia zadania:
    </p>
    <div class="container my-3 p-2" id="challengeCode">
        const endpoint = 'https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json';
        const cities = [];
        var req = new XMLHttpRequest();
        req.open('GET', endpoint, true);
        req.send();
        req.onload = function () {
        if (this.status == 200) {
        JSON.parse(this.responseText).forEach(city =>cities.push(city));
        console.log(cities);


        } else {
        console.log(this.status);
        }
        }
        const challenge_6_search = document.getElementById("challenge_6_input");
        const show_more_button = document.getElementById("show_more");
        challenge_6_search.addEventListener('keyup', search);

        function search() {
        document.getElementById("City_research").innerHTML = '';
        show_more_button.style.display = 'none';
        cities.forEach(element => {
        if (element.city.includes(challenge_6_search.value)) {
        if (document.getElementById("City_research").childElementCount < 10) {
        document.getElementById("City_research").innerHTML += '<li><a href="#">City: ' + element.city + '</br>Population: ' + element.population + '</a></li>';
        }
        else {
        document.getElementById("City_research").innerHTML += '<li style="display:none" class="hidden_cities"><a href="#">City: ' + element.city + '</br>Population: ' + element.population + '</a></li>';
        show_more_button.style.display = 'block';
        show_more_button.addEventListener('click', displayAllCities);
        }

        }
        })
        };

        function displayAllCities() {
        document.querySelectorAll('.hidden_cities').forEach(el => el.style.display = 'block');
        show_more_button.style.display = 'none';
        };

    </div>
</div>

</body>
</html>

